package jp.eagan.gotaku;

import java.io.ByteArrayInputStream;
import java.io.InputStream;

import org.junit.Test;

import static org.junit.Assert.*;

public class GotakuReaderTest {
	
	/**
	 * 入力ストリームの末尾では Null を返すことを確認する。
	 */
	@Test
	public void testReadQuizEOF() throws Exception {
		byte[] testBytes = {};
		InputStream testStream = new ByteArrayInputStream(testBytes);
		Quiz testQuiz = GotakuReader.readQuiz(testStream);
		assertNull(testQuiz);
	}
	
	/**
	 * フィールド長を確認する。
	 */
	@Test
	public void testReadQuizLength() throws Exception {
		byte[] testBytes = {
				// 0     1     2     3     4     5     6     7     8     9     a     b     c     d     e     f
				0x16, 0x62, 0x11, 0x68, 0x15, 0x36, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
				0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
				0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
				0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
				0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
				0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
				0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
				0x20, 0x20, 0x20, 0x20, 0x09, 0x71, 0x13, 0x1a, 0x02, (byte) 0xd0, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
				0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
				0x09, 0x71, 0x13, 0x1a, 0x02, (byte) 0xd1, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
				0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x09, 0x71, 0x13, 0x1a,
				0x02, (byte) 0xd2, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
				0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x09, 0x71, 0x13, 0x1a, 0x02, (byte) 0xd3, 0x20, 0x20,
				0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
				0x20, 0x20, 0x20, 0x20, 0x09, 0x71, 0x13, 0x1a, 0x02, (byte) 0xd4, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
				0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20
		};
		InputStream testStream = new ByteArrayInputStream(testBytes);
		Quiz testQuiz = GotakuReader.readQuiz(testStream);
		assertNotNull(testQuiz);
		String question = testQuiz.getQuestion();
		assertEquals("問題文", question);
		String[] answers = testQuiz.getAnswers();
		assertNotNull(answers);
		assertEquals(5, answers.length);
		assertEquals("回答１", answers[0]);
		assertEquals("回答２", answers[1]);
		assertEquals("回答３", answers[2]);
		assertEquals("回答４", answers[3]);
		assertEquals("回答５", answers[4]);
	}

	/**
	 * フィールド長を確認する。
	 */
	@Test
	public void testReadQuiz() throws Exception {
		byte[] testBytes = {
				// 0     1     2     3     4     5     6     7     8     9     a     b     c     d     e     f
				0x02, 0x20, 0x02, 0x20, 0x02, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
				0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
				0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
				0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
				0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
				0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
				0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
				0x20, 0x20, 0x20, 0x20, 0x09, 0x71, 0x13, 0x1a, 0x02, (byte) 0xd0, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
				0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
				0x09, 0x71, 0x13, 0x1a, 0x02, (byte) 0xd1, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
				0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x09, 0x71, 0x13, 0x1a,
				0x02, (byte) 0xd2, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
				0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x09, 0x71, 0x13, 0x1a, 0x02, (byte) 0xd3, 0x20, 0x20,
				0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
				0x20, 0x20, 0x20, 0x20, 0x09, 0x71, 0x13, 0x1a, 0x02, (byte) 0xd4, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
				0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20
		};
		InputStream testStream = new ByteArrayInputStream(testBytes);
		Quiz testQuiz = GotakuReader.readQuiz(testStream);
		assertNotNull(testQuiz);
		String question = testQuiz.getQuestion();
		assertEquals("あああ", question);
		String[] answers = testQuiz.getAnswers();
		assertNotNull(answers);
		assertEquals(5, answers.length);
		assertEquals("回答１", answers[0]);
		assertEquals("回答２", answers[1]);
		assertEquals("回答３", answers[2]);
		assertEquals("回答４", answers[3]);
		assertEquals("回答５", answers[4]);
	}
	
}
